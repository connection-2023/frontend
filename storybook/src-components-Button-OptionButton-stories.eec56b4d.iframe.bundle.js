"use strict";(self.webpackChunkproject_connection=self.webpackChunkproject_connection||[]).push([[542],{"./src/components/Button/OptionButton.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>OptionButton_stories});var react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),next_link=__webpack_require__("./node_modules/next/link.js"),link_default=__webpack_require__.n(next_link),navigation=__webpack_require__("./node_modules/next/navigation.js"),react_toastify_esm=__webpack_require__("./node_modules/react-toastify/dist/react-toastify.esm.mjs"),useClickAway=__webpack_require__("./node_modules/react-use/esm/useClickAway.js"),svg=__webpack_require__("./public/icons/svg.ts"),instructorLikesBlockApis=__webpack_require__("./src/lib/apis/instructorLikesBlockApis.ts"),userApi=__webpack_require__("./src/lib/apis/userApi.ts"),store=__webpack_require__("./src/store/index.ts"),process=__webpack_require__("./node_modules/process/browser.js"),Sharing_process=__webpack_require__("./node_modules/process/browser.js"),console=__webpack_require__("./node_modules/console-browserify/index.js"),__jsx=react.createElement,DOMAIN=Sharing_process.env.NEXT_PUBLIC_DOMAIN,shareOptions=[{label:"카카오톡",button:__jsx("button",{className:"flex h-[35px] w-[35px] items-center justify-center rounded-full bg-kakao"},__jsx(svg.kz,{width:"17",height:"16"}))},{label:"페이스북",button:__jsx(svg.EG,null)},{label:"X",button:__jsx(svg.cC,null)},{label:"링크복사",button:__jsx("button",{className:"flex h-[35px] w-[35px] items-center justify-center rounded-full bg-sub-color1 "},__jsx(svg.mM,{className:"fill-white"}))}],Sharing=function Sharing(_ref){var mode=_ref.mode,header=_ref.header;return __jsx("div",{className:"flex flex-col items-center"},__jsx("p",{className:"flex w-full items-center justify-center border-b border-solid border-gray-700 py-3 text-sm font-semibold"},"공유하기"),__jsx("div",{className:"border-box flex items-center gap-[1.41rem] px-4 py-[0.69rem]"},shareOptions.map((function(option){return __jsx(ShareButton,{key:option.label,mode,header,label:option.label,button:option.button})}))))};Sharing.displayName="Sharing";const Button_Sharing=Sharing;var ShareButton=function ShareButton(_ref2){var label=_ref2.label,button=_ref2.button,header=_ref2.header,title="class"===_ref2.mode?"Connection - "+header:"Connection - 강사 프로필 "+header,pageUrl=DOMAIN+(0,navigation.usePathname)();(0,react.useEffect)((function(){var script=document.createElement("script");return script.src="https://developers.kakao.com/sdk/js/kakao.js",script.async=!0,document.body.appendChild(script),function(){document.body.removeChild(script)}}),[]);return __jsx("div",{onClick:function handleClick(){switch(label){case"카카오톡":!function shareToKakaoTalk(url){if(void 0!==window.Kakao){var kakao=window.Kakao;kakao.isInitialized()||kakao.init(process.env.NEXT_PUBLIC_KAKAO_SHARE_KEY),kakao.Share.sendScrap({templateId:98927,requestUrl:url})}}(pageUrl);break;case"페이스북":!function shareToFacebook(title,url){var sharedLink=encodeURIComponent(url);window.open("http://www.facebook.com/sharer/sharer.php?u=".concat(sharedLink),"_blank","width=500,height=700")}(0,pageUrl);break;case"X":!function shareToTwitter(title,url){var sharedLink="text="+encodeURIComponent(title+" \n ")+encodeURIComponent(url);window.open("https://twitter.com/intent/tweet?".concat(sharedLink),"_blank","width=500,height=700")}(title,pageUrl);break;case"링크복사":navigator.clipboard.writeText(pageUrl).then((function(){react_toastify_esm.Am.success("클립보드에 복사되었습니다!")})).catch((function(err){console.error("Could not copy text: ",err)}))}},className:"flex cursor-pointer flex-col items-center justify-center whitespace-nowrap"},button,__jsx("label",{className:"mt-[0.41rem] cursor-pointer text-xs font-semibold"},label))};ShareButton.displayName="ShareButton";var Modal=__webpack_require__("./src/components/Modal/Modal.tsx"),OptionButtons_console=__webpack_require__("./node_modules/console-browserify/index.js"),OptionButtons_jsx=react.createElement,OptionButtons=function OptionButtons(_ref){var mode=_ref.mode,lecturerId=_ref.lecturerId,title=_ref.title,likes=_ref.likes,pathname=(0,navigation.usePathname)(),loggedInUserType=(0,store.LM)((function(state){return state.userType})),loggedInUser=(0,store.LM)((function(state){return state.authUser})),_useState=(0,react.useState)(!1),isOptionMenuOpened=_useState[0],setIsOptionMenuOpened=_useState[1],_useState2=(0,react.useState)(!1),isSharingMenuOpened=_useState2[0],setIsSharingMenuOpened=_useState2[1],optionButtonRef=(0,react.useRef)(null),isWriter=Number(null==loggedInUser?void 0:loggedInUser.id)===Number(lecturerId)&&"lecturer"===loggedInUserType;(0,useClickAway.Z)(optionButtonRef,(function(){isOptionMenuOpened&&setIsOptionMenuOpened(!1)}));var liStyles="flex cursor-pointer items-center gap-1.5 px-2 hover:bg-gray-700 py-1.5",instructorBlockHandler=function(){var _ref2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,(0,instructorLikesBlockApis.tc)(lecturerId);case 3:if(!likes){_context.next=6;break}return _context.next=6,(0,instructorLikesBlockApis.u1)(lecturerId);case 6:react_toastify_esm.Am.success("강사 차단 완료"),_context.next=27;break;case 9:if(_context.prev=9,_context.t0=_context.catch(0),!(_context.t0 instanceof Error)){_context.next=27;break}if(401!==_context.t0.status){_context.next=26;break}return _context.prev=14,_context.next=17,(0,userApi.Yc)();case 17:return _context.next=19,instructorBlockHandler();case 19:_context.next=24;break;case 21:_context.prev=21,_context.t1=_context.catch(14),OptionButtons_console.error(_context.t1);case 24:_context.next=27;break;case 26:react_toastify_esm.Am.error("잘못된 요청입니다!");case 27:case"end":return _context.stop()}}),_callee,null,[[0,9],[14,21]])})));return function instructorBlockHandler(){return _ref2.apply(this,arguments)}}();return OptionButtons_jsx("div",{ref:optionButtonRef,className:"relative flex items-center gap-2"},OptionButtons_jsx(svg.ci,{onClick:function onClick(){return setIsOptionMenuOpened((function(prev){return!prev}))},className:"peer cursor-pointer hover:fill-black ".concat(isOptionMenuOpened?"fill-black":"fill-gray-500")}),isOptionMenuOpened&&OptionButtons_jsx("ul",{className:"absolute right-0 top-6 w-24 overflow-hidden whitespace-nowrap rounded-md bg-white text-sm font-medium text-black shadow-float"},OptionButtons_jsx("li",{onClick:function onClick(){setIsSharingMenuOpened(!isSharingMenuOpened)},className:liStyles},OptionButtons_jsx(svg.YJ,{width:"14px",height:"14px",className:"fill-sub-color1"}),"공유하기"),isWriter?OptionButtons_jsx("li",null,OptionButtons_jsx(link_default(),{href:"".concat(pathname,"/edit"),className:liStyles},OptionButtons_jsx(svg.Wi,{width:"15px",height:"15px",className:"fill-sub-color1"}),"수정하기")):OptionButtons_jsx(react.Fragment,null,OptionButtons_jsx("li",null,OptionButtons_jsx(link_default(),{href:"/report?targetLecturerId=".concat(lecturerId),className:liStyles},OptionButtons_jsx(svg.eC,{width:"15px",height:"15px",className:"fill-sub-color1"}),"신고하기")),OptionButtons_jsx("li",{className:liStyles,onClick:instructorBlockHandler},OptionButtons_jsx(svg.sN,{width:"15px",height:"15px",className:"fill-sub-color1"}),"차단하기"))),isSharingMenuOpened&&OptionButtons_jsx(Modal.Z,{isOpened:isSharingMenuOpened,handleClosed:function handleClosed(){setIsSharingMenuOpened(!1)}},OptionButtons_jsx(Button_Sharing,{mode,header:title})))};OptionButtons.displayName="OptionButtons";const Button_OptionButtons=OptionButtons;var OptionButton_stories_jsx=react.createElement;const OptionButton_stories={title:"Components/Buttons/OptionButtons",component:Button_OptionButtons,parameters:{layout:"centered",docs:{description:{component:"클래스/강사 상세페이지에서 사용되는 공유하기, 신고하기, 차단하기 옵션의 옵션 버튼 컴포넌트"}}},tags:["autodocs"],argTypes:{title:{description:"공유하기 제목",control:"text"},lecturerId:{description:"클래스 및 강사 신고/차단 시 강사 id",control:"number"},mode:{description:"공유하기 모드",options:["class","instructor"],control:{type:"radio"}}}};var Default={args:{mode:"class",title:"Connection 댄스 클래스",lecturerId:0},render:function render(args){return OptionButton_stories_jsx("div",{className:"h-32 w-full"},OptionButton_stories_jsx(Button_OptionButtons,args))}};Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{\n  args: {\n    mode: 'class',\n    title: 'Connection 댄스 클래스',\n    lecturerId: 0\n  },\n  render: args => <div className=\"h-32 w-full\">\n      <OptionButtons {...args} />\n    </div>\n}",...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"]},"./src/components/Modal/Modal.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>Modal_Modal});var react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),use_animation=__webpack_require__("./node_modules/framer-motion/dist/es/animation/hooks/use-animation.mjs");const hooks_usePreviousValue=function usePreviousValue(value){var previousValueRef=(0,react.useRef)();return(0,react.useEffect)((function(){previousValueRef.current=value}),[value]),previousValueRef.current};const hooks_useBottomSheet=function useBottomSheet(handleClosed,isOpened){var controls=(0,use_animation._)(),prevIsOpen=hooks_usePreviousValue(isOpened);return(0,react.useEffect)((function(){prevIsOpen&&!isOpened?controls.start("hidden"):!prevIsOpen&&isOpened&&controls.start("visible")}),[controls,isOpened,prevIsOpen]),{onDragEnd:function onDragEnd(event,info){info.point.y>20||info.point.y>=0&&info.point.y>45?controls.start("hidden").then(handleClosed):controls.start("visible")},controls,isOpened}};var motion=__webpack_require__("./node_modules/framer-motion/dist/es/render/dom/motion.mjs"),navigation=__webpack_require__("./node_modules/next/navigation.js");const hooks_useMediaQuery=function useMediaQuery(query){var isClient="object"==typeof window,_useState=(0,react.useState)(!!isClient&&window.matchMedia(query).matches),matches=_useState[0],setMatches=_useState[1];return(0,react.useEffect)((function(){if(isClient){var media=window.matchMedia(query),listener=function listener(event){return setMatches(event.matches)};return media.addEventListener("change",listener),function(){return media.removeEventListener("change",listener)}}}),[isClient,matches,query]),matches};var svg=__webpack_require__("./public/icons/svg.ts"),__jsx=react.createElement;const Modal_ModalContent=function ModalContent(_ref){var children=_ref.children,handleClosed=_ref.handleClosed,disableModalSwipe=_ref.disableModalSwipe,onDragEnd=_ref.onDragEnd,controls=_ref.controls,skipBackOnUnmount=_ref.skipBackOnUnmount,modalHistroryControl=_ref.modalHistroryControl,initialized=(0,react.useRef)(!1),isSm=disableModalSwipe?void 0:hooks_useMediaQuery("(min-width: 640px)"),pathname=(0,navigation.usePathname)(),closeModalHandler=function closeModalHandler(){handleClosed(),modalHistroryControl&&(window.onpopstate=null,window.history.back(),skipBackOnUnmount.current=!0)},handleKeyUp=function handleKeyUp(e){"Escape"===e.key&&closeModalHandler()};return(0,react.useEffect)((function(){if(modalHistroryControl)return initialized.current?function(){window.removeEventListener("keyup",handleKeyUp),window.onpopstate=null,skipBackOnUnmount.current||window.history.back()}:(window.addEventListener("keyup",handleKeyUp),window.history.pushState(null,"",pathname),window.onpopstate=function(){handleClosed(),window.onpopstate=null,skipBackOnUnmount.current=!0},initialized.current=!0,void(skipBackOnUnmount.current=!1))}),[]),disableModalSwipe?__jsx("div",{className:"absolute bottom-0 z-modal h-screen w-screen bg-white sm:bottom-auto sm:left-1/2 sm:top-1/2 sm:h-auto sm:w-auto sm:-translate-x-1/2 sm:-translate-y-1/2 sm:rounded-md sm:pt-0 sm:shadow-float"},__jsx("button",{onClick:closeModalHandler,className:"absolute right-6 top-5"},__jsx(svg.b2,{width:"24",height:"24",className:"stroke-gray-500 stroke-2"})),children):__jsx(motion.E.div,{drag:!isSm&&"y",onDragEnd:isSm?void 0:onDragEnd,initial:!isSm&&"hidden",animate:!isSm&&controls,transition:{type:"spring",damping:40,stiffness:400},variants:{visible:{y:0},hidden:{y:"100%"}},dragConstraints:{top:0},dragElastic:.2,style:isSm?{y:"-50%",x:"-50%"}:void 0,className:"absolute bottom-0 z-modal h-[90%] w-screen rounded-t-lg bg-white pt-2.5 sm:bottom-auto sm:left-1/2 sm:top-1/2 sm:h-auto sm:w-auto sm:rounded-md sm:pt-0 sm:shadow-float"},__jsx("button",{onClick:closeModalHandler,className:"absolute right-2 top-2 hidden sm:block"},__jsx(svg.b2,{width:"24",height:"24",className:"stroke-gray-500 stroke-2"})),__jsx("div",{className:"mb-8 flex w-full justify-center sm:hidden"},__jsx("button",{className:"h-1.5 w-16 rounded-lg bg-gray-700"})),children)};var Modal_jsx=react.createElement;const Modal_Modal=function Modal(_ref){var children=_ref.children,isOpened=_ref.isOpened,handleClosed=_ref.handleClosed,_ref$disableModalSwip=_ref.disableModalSwipe,disableModalSwipe=void 0!==_ref$disableModalSwip&&_ref$disableModalSwip,_ref$modalHistroryCon=_ref.modalHistroryControl,modalHistroryControl=void 0===_ref$modalHistroryCon||_ref$modalHistroryCon,skipBackOnUnmount=(0,react.useRef)(!1),closeModalHandler=function closeModalHandler(){handleClosed(),modalHistroryControl&&(window.onpopstate=null,window.history.back(),skipBackOnUnmount.current=!0)},_useBottomSheet=hooks_useBottomSheet(closeModalHandler,isOpened),onDragEnd=_useBottomSheet.onDragEnd,controls=_useBottomSheet.controls,overlayRef=(0,react.useRef)(null);return isOpened?Modal_jsx("div",{ref:overlayRef,className:"fixed bottom-0 left-0 right-0 top-0 z-modal mx-auto bg-black/60 backdrop-blur-sm",onClick:function onClick(e){overlayRef.current===e.target&&closeModalHandler()}},Modal_jsx(Modal_ModalContent,{children,handleClosed,disableModalSwipe,onDragEnd,controls,skipBackOnUnmount,modalHistroryControl})):null}},"./src/lib/apis/instructorLikesBlockApis.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{DR:()=>instructorsLikes,tc:()=>instructorsBlock,u1:()=>instructorsLikeCancel});var _home_runner_work_frontend_frontend_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),_home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__),console=__webpack_require__("./node_modules/console-browserify/index.js"),instructorsLikeCancel=function(){var _ref2=(0,_home_runner_work_frontend_frontend_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__.Z)(_home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee2(lectureId){var response,errorData,error,data;return _home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.prev=0,_context2.next=3,fetch("/api/users/instructors/like-cancel?lectureId=".concat(encodeURIComponent(lectureId)),{method:"DELETE",credentials:"include"});case 3:if((response=_context2.sent).ok){_context2.next=11;break}return _context2.next=7,response.json();case 7:throw errorData=_context2.sent,(error=new Error(errorData.message||"")).status=response.status,error;case 11:return _context2.next=13,response.json();case 13:return data=_context2.sent,_context2.abrupt("return",data);case 17:throw _context2.prev=17,_context2.t0=_context2.catch(0),console.error("강사좋아요 취소 오류",_context2.t0),_context2.t0;case 21:case"end":return _context2.stop()}}),_callee2,null,[[0,17]])})));return function instructorsLikeCancel(_x2){return _ref2.apply(this,arguments)}}(),instructorsLikes=function(){var _ref3=(0,_home_runner_work_frontend_frontend_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__.Z)(_home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee3(lectureId){var response,errorData,error,data;return _home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.prev=0,_context3.next=3,fetch("/api/users/instructors/likes?lectureId=".concat(encodeURIComponent(lectureId)),{method:"POST",credentials:"include"});case 3:if((response=_context3.sent).ok){_context3.next=11;break}return _context3.next=7,response.json();case 7:throw errorData=_context3.sent,(error=new Error(errorData.message||"")).status=response.status,error;case 11:return _context3.next=13,response.json();case 13:return data=_context3.sent,_context3.abrupt("return",data);case 17:throw _context3.prev=17,_context3.t0=_context3.catch(0),console.error("강사 좋아요 오류",_context3.t0),_context3.t0;case 21:case"end":return _context3.stop()}}),_callee3,null,[[0,17]])})));return function instructorsLikes(_x3){return _ref3.apply(this,arguments)}}(),instructorsBlock=function(){var _ref4=(0,_home_runner_work_frontend_frontend_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_1__.Z)(_home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee4(lectureId){var response,errorData,error,data;return _home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.prev=0,_context4.next=3,fetch("/api/users/instructors/block?lectureId=".concat(encodeURIComponent(lectureId)),{method:"POST",credentials:"include"});case 3:if((response=_context4.sent).ok){_context4.next=11;break}return _context4.next=7,response.json();case 7:throw errorData=_context4.sent,(error=new Error(errorData.message||"")).status=response.status,error;case 11:return _context4.next=13,response.json();case 13:return data=_context4.sent,_context4.abrupt("return",data);case 17:throw _context4.prev=17,_context4.t0=_context4.catch(0),console.error("강사 차단 오류",_context4.t0),_context4.t0;case 21:case"end":return _context4.stop()}}),_callee4,null,[[0,17]])})));return function instructorsBlock(_x4){return _ref4.apply(this,arguments)}}()},"./src/lib/apis/userApi.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Yc:()=>accessTokenReissuance});var _home_runner_work_frontend_frontend_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),_home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__),console=(__webpack_require__("./node_modules/react-toastify/dist/react-toastify.esm.mjs"),__webpack_require__("./node_modules/console-browserify/index.js")),accessTokenReissuance=function(){var _ref8=(0,_home_runner_work_frontend_frontend_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_2__.Z)(_home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee8(){var response;return _home_runner_work_frontend_frontend_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.prev=0,_context8.next=3,fetch("/api/auth/refresh",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"},redirect:"manual"});case 3:return"opaqueredirect"===(response=_context8.sent).type&&(window.location.href=response.url),_context8.abrupt("return",response);case 8:throw _context8.prev=8,_context8.t0=_context8.catch(0),console.error("엑세스 토큰 재발급 오류",_context8.t0),_context8.t0;case 12:case"end":return _context8.stop()}}),_callee8,null,[[0,8]])})));return function accessTokenReissuance(){return _ref8.apply(this,arguments)}}()}}]);